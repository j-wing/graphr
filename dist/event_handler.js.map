{"version":3,"sources":["js/es6/event_handler.js"],"names":[],"mappings":"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","file":"js/es6/event_handler.js","sourcesContent":["export class EventHandler {\n\tconstructor(canvasID, latencies) {\n\t\tthis._interactables = []\n\t\tthis.mousePos = [0, 0]\n\n\t\t// Cache the $(canvas) jQuery object\n\t\tthis.canvas = $(canvasID)\n\n\t\t// Define custom events\n\t\tthis.longpressLatency = latencies['longpress']\n\t}\n\n\taddInteractable(interactable) {\n\t\tthis._interactables.push(interactable)\n\t}\n\n\tget mousePosX() {\n\t\treturn this.mousePos[0]\n\t}\n\n\tget mousePosY() {\n\t\treturn this.mousePos[1]\n\t}\n\n\tgetCurrMousePos(e) {\n\t\treturn [ e.pageX - this.canvas.offset().left,\n\t\t\t\t e.pageY - this.canvas.offset().top ]\n\t}\n\n\tmousedownHandler(e) {\n\t\t// console.log(this.canvas)\n\t\tthis.mousePos = this.getCurrMousePos(e)\n\n\t\tconsole.log(this.mousePos)\n\t\tconsole.log(\"mousedown\")\n\n\t\tthis.mousedown = true\n\n\t\t// Trigger a longPress event if mousedown for > 1sec\n\t\tthis.longPress = window.setTimeout(() => {\n\t\t\tthis.mousedown = false\n\n\t\t\tvar e = new CustomEvent(\"longpress\", {\n\t\t\t\tdetail: {},\n\t\t\t\tbubbles: true,\n\t\t\t\tcancelable: true\n\t\t\t})\n\n\t\t\tthis.canvas[0].dispatchEvent(e)\n\t\t}, this.longpressLatency)\n\t}\n\n\tmouseupHandler(e) {\n\t\t// Cancel the longPress event if mouseup\n\n\t\twindow.clearTimeout(this.longPress)\n\n\t\t// Update mousePos\n\t\tvar endPos = this.getCurrMousePos(e)\n\n\t\tconsole.log(\"mouseup\")\n\n\t\t// check if endPos is in some interactable's bounds,\n\t\t// and if so, call the corresponding click method\n\t\tvar startNode = null\n\t\tvar endNode = null\n\t\tfor (var interactable of this._interactables) {\n\t\t\tif (interactable.posInBound(this.mousePos)) {\n\t\t\t\tstartNode = interactable\n\t\t\t}\n\n\t\t\tif (interactable.posInBound(endPos)) {\n\t\t\t\tendNode = interactable\n\t\t\t}\n\t\t}\n\n\t\tif (startNode != null & endNode != null) {\n\t\t\tif (startNode === endNode) {\n\t\t\t\tstartNode.handleClick()\n\t\t\t} else {\n\n\t\t\t\t// Dispatch an event to create an edge\n\t\t\t\tvar e = new CustomEvent(\"edgecreated\", {\n\t\t\t\t\tdetail: {\n\t\t\t\t\t\tstart: startNode,\n\t\t\t\t\t\tend: endNode\n\t\t\t\t\t},\n\t\t\t\t\tbubbles: true,\n\t\t\t\t\tcancelable: false\n\t\t\t\t})\n\n\t\t\t\t$(\"#canvas\")[0].dispatchEvent(e)\n\t\t\t}\n\t\t}\n\n\t\tthis.mousedown = false\n\t}\n}\n\n// Events\n/*\n\nClick\nkeypress\nmousedown\nmouseup\n\ntouchstart\ntouchend\n\n*/"]}